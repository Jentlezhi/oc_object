<?xml version="1.0" encoding="UTF-8"?>
<!DOCTYPE html PUBLIC "-//W3C//DTD XHTML 1.0 Transitional//EN" "http://www.w3.org/TR/xhtml1/DTD/xhtml1-transitional.dtd">
<html><head><meta http-equiv="Content-Type" content="text/html; charset=UTF-8"/><meta name="exporter-version" content="Evernote Mac 9.2.1 (458835)"/><meta name="author" content="juntaozhi@163.com"/><meta name="created" content="2019-10-22 22:37:18 +0000"/><meta name="source" content="desktop.mac"/><meta name="updated" content="2019-11-12 03:23:23 +0000"/><meta name="content-class" content="yinxiang.markdown"/><title>11. KVC</title></head><body><div style="font-size: 14px; margin: 0; padding: 0; width: 100%;"><h3 style="line-height: 160%; box-sizing: content-box; font-weight: 700; font-size: 27px; color: #333;">KVC</h3>
<h4 style="line-height: 160%; box-sizing: content-box; font-size: 20px; color: #333;">1.通过KVC修改属性会触发KVO吗？</h4>
<blockquote style="line-height: 160%; box-sizing: content-box; margin: 15px 0; border-left: 4px solid #ddd; padding: 0 15px; color: #777;">
<p style="line-height: 160%; box-sizing: content-box; margin: 10px 0; color: #333; margin-top: 0; margin-bottom: 0;">会触发KVO,这就涉及到KVC的原理</p>
</blockquote>
<h5 style="line-height: 160%; box-sizing: content-box; font-weight: 700; font-size: 16px; color: #333;">1.1 KVC的原理</h5>
<ul style="line-height: 160%; box-sizing: content-box; display: block; list-style-type: disc; padding-left: 30px; margin: 6px 0 10px; color: #333;">
<li style="line-height: 160%; box-sizing: content-box; position: relative;">
<p style="line-height: 160%; box-sizing: content-box; color: #333; margin: 0;">setValue: forKey: 按照setKey:、_setKey:顺序查找</p>
</li>
<li style="line-height: 160%; box-sizing: content-box; position: relative;">
<p style="line-height: 160%; box-sizing: content-box; color: #333; margin: 0;">setValue: forKey: 调用按顺序setKey:、_setKey:调用其中一个方法，不关心是否有成员变量或属性。<br/>
<img src="11.%20KVC.resources/Snip20191023_1.png" height="500" width="1142"/><br/>
<img src="11.%20KVC.resources/Snip20191023_2.png" height="754" width="1206"/><br/>
<img src="11.%20KVC.resources/Snip20191023_3.png" height="266" width="1162"/></p>
</li>
<li style="line-height: 160%; box-sizing: content-box; position: relative;">
<p style="line-height: 160%; box-sizing: content-box; color: #333; margin: 0;">如果以上两个方法均未实现</p>
</li>
</ul>
<blockquote style="line-height: 160%; box-sizing: content-box; margin: 15px 0; border-left: 4px solid #ddd; padding: 0 15px; color: #777;">
<p style="line-height: 160%; box-sizing: content-box; margin: 10px 0; color: #333; margin-top: 0; margin-bottom: 0;">则会调用系统的一个函数来决定是否可以直接访问成员变量<br/>
<img src="11.%20KVC.resources/Snip20191109_4.png" height="358" width="1398"/></p>
</blockquote>
<p style="line-height: 160%; box-sizing: content-box; margin: 10px 0; color: #333;"><u style="line-height: 160%; box-sizing: content-box;">以上两个方法均未实现且accessInstanceVariablesDirectly函数返回为NO的时候，直接访问会导致崩溃</u></p>
<ul style="line-height: 160%; box-sizing: content-box; display: block; list-style-type: disc; padding-left: 30px; margin: 6px 0 10px; color: #333;">
<li style="line-height: 160%; box-sizing: content-box; position: relative;">如果可以访问成员变量，则会按照_key、_isKey、key、isKey的顺序查找成员变量，找到了成员变量就会直接赋值，找不到就会报找不到key的错误【崩溃】</li>
</ul>
<h5 style="line-height: 160%; box-sizing: content-box; font-weight: 700; font-size: 16px; color: #333;">1.2 KVC取值的原理</h5>
<p style="line-height: 160%; box-sizing: content-box; margin: 10px 0; color: #333;"><a href="https://www.jianshu.com/p/2afb63b8859c" style="line-height: 160%; box-sizing: content-box; text-decoration: underline; color: #5286bc;">kvc取值原理</a><br/>
orKey:@"_age"]);</p>
<pre style="line-height: 160%; box-sizing: content-box; border: 0; border-radius: 0; margin: 2px 0 8px; background-color: #f5f7f8;"><code style="display: block; overflow-x: auto; background: #1e1e1e; line-height: 160%; box-sizing: content-box; border: 0; border-radius: 0; letter-spacing: -.3px; padding: 18px; color: #f4f4f4; white-space: pre-wrap;">
##### 1.3 valueForKey详解
[value for keyPath](https://blog.csdn.net/pangshishan1/article/details/84258792)</code></pre>
</div><center style="display:none !important;visibility:collapse !important;height:0 !important;white-space:nowrap;width:100%;overflow:hidden">%23%23%23%20KVC%0A%0A%23%23%23%23%201.%E9%80%9A%E8%BF%87KVC%E4%BF%AE%E6%94%B9%E5%B1%9E%E6%80%A7%E4%BC%9A%E8%A7%A6%E5%8F%91KVO%E5%90%97%EF%BC%9F%0A%0A%3E%20%E4%BC%9A%E8%A7%A6%E5%8F%91KVO%2C%E8%BF%99%E5%B0%B1%E6%B6%89%E5%8F%8A%E5%88%B0KVC%E7%9A%84%E5%8E%9F%E7%90%86%0A%0A%23%23%23%23%23%201.1%20KVC%E7%9A%84%E5%8E%9F%E7%90%86%0A%0A*%20setValue%3A%20forKey%3A%20%E6%8C%89%E7%85%A7setKey%3A%E3%80%81_setKey%3A%E9%A1%BA%E5%BA%8F%E6%9F%A5%E6%89%BE%0A*%20setValue%3A%20forKey%3A%20%E8%B0%83%E7%94%A8%E6%8C%89%E9%A1%BA%E5%BA%8FsetKey%3A%E3%80%81_setKey%3A%E8%B0%83%E7%94%A8%E5%85%B6%E4%B8%AD%E4%B8%80%E4%B8%AA%E6%96%B9%E6%B3%95%EF%BC%8C%E4%B8%8D%E5%85%B3%E5%BF%83%E6%98%AF%E5%90%A6%E6%9C%89%E6%88%90%E5%91%98%E5%8F%98%E9%87%8F%E6%88%96%E5%B1%9E%E6%80%A7%E3%80%82%0A!%5Bcc27d9843950966e1bdaa37490783b2b.png%5D(evernotecid%3A%2F%2FBBF753C8-04E8-4721-A710-F3D5D13EB8CD%2Fappyinxiangcom%2F21790515%2FENResource%2Fp3066)%0A!%5B5be401ce802c5fe70328e28bfbd7527d.png%5D(evernotecid%3A%2F%2FBBF753C8-04E8-4721-A710-F3D5D13EB8CD%2Fappyinxiangcom%2F21790515%2FENResource%2Fp3067)%0A!%5Bcdf20c4a6ee0b866d78e3680f33d4d96.png%5D(evernotecid%3A%2F%2FBBF753C8-04E8-4721-A710-F3D5D13EB8CD%2Fappyinxiangcom%2F21790515%2FENResource%2Fp3068)%0A%0A%0A*%20%E5%A6%82%E6%9E%9C%E4%BB%A5%E4%B8%8A%E4%B8%A4%E4%B8%AA%E6%96%B9%E6%B3%95%E5%9D%87%E6%9C%AA%E5%AE%9E%E7%8E%B0%0A%3E%20%E5%88%99%E4%BC%9A%E8%B0%83%E7%94%A8%E7%B3%BB%E7%BB%9F%E7%9A%84%E4%B8%80%E4%B8%AA%E5%87%BD%E6%95%B0%E6%9D%A5%E5%86%B3%E5%AE%9A%E6%98%AF%E5%90%A6%E5%8F%AF%E4%BB%A5%E7%9B%B4%E6%8E%A5%E8%AE%BF%E9%97%AE%E6%88%90%E5%91%98%E5%8F%98%E9%87%8F%0A!%5Bf31ff89bf303245befc8e5126cb645d1.png%5D(evernotecid%3A%2F%2FBBF753C8-04E8-4721-A710-F3D5D13EB8CD%2Fappyinxiangcom%2F21790515%2FENResource%2Fp3071)%0A%0A%3Cu%3E%E4%BB%A5%E4%B8%8A%E4%B8%A4%E4%B8%AA%E6%96%B9%E6%B3%95%E5%9D%87%E6%9C%AA%E5%AE%9E%E7%8E%B0%E4%B8%94accessInstanceVariablesDirectly%E5%87%BD%E6%95%B0%E8%BF%94%E5%9B%9E%E4%B8%BANO%E7%9A%84%E6%97%B6%E5%80%99%EF%BC%8C%E7%9B%B4%E6%8E%A5%E8%AE%BF%E9%97%AE%E4%BC%9A%E5%AF%BC%E8%87%B4%E5%B4%A9%E6%BA%83%3C%2Fu%3E%0A%0A%0A*%20%E5%A6%82%E6%9E%9C%E5%8F%AF%E4%BB%A5%E8%AE%BF%E9%97%AE%E6%88%90%E5%91%98%E5%8F%98%E9%87%8F%EF%BC%8C%E5%88%99%E4%BC%9A%E6%8C%89%E7%85%A7_key%E3%80%81_isKey%E3%80%81key%E3%80%81isKey%E7%9A%84%E9%A1%BA%E5%BA%8F%E6%9F%A5%E6%89%BE%E6%88%90%E5%91%98%E5%8F%98%E9%87%8F%EF%BC%8C%E6%89%BE%E5%88%B0%E4%BA%86%E6%88%90%E5%91%98%E5%8F%98%E9%87%8F%E5%B0%B1%E4%BC%9A%E7%9B%B4%E6%8E%A5%E8%B5%8B%E5%80%BC%EF%BC%8C%E6%89%BE%E4%B8%8D%E5%88%B0%E5%B0%B1%E4%BC%9A%E6%8A%A5%E6%89%BE%E4%B8%8D%E5%88%B0key%E7%9A%84%E9%94%99%E8%AF%AF%E3%80%90%E5%B4%A9%E6%BA%83%E3%80%91%0A%0A%23%23%23%23%23%201.2%20KVC%E5%8F%96%E5%80%BC%E7%9A%84%E5%8E%9F%E7%90%86%0A%0A%5Bkvc%E5%8F%96%E5%80%BC%E5%8E%9F%E7%90%86%5D(https%3A%2F%2Fwww.jianshu.com%2Fp%2F2afb63b8859c)%0A%0A%0A%23%23%23%23%23%201.3%20valueForKey%E8%AF%A6%E8%A7%A3%0A%5Bvalue%20for%20keyPath%5D(https%3A%2F%2Fblog.csdn.net%2Fpangshishan1%2Farticle%2Fdetails%2F84258792)</center></body></html>